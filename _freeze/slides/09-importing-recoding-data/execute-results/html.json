{
  "hash": "6b056e6480ef0272576d835489f76d46",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Importing and recoding data\"\nsubtitle: \"Lecture 9\"\ndate: \"2025-02-11\"\nformat: revealjs\nauto-stretch: false\n---\n\n\n\n<!-- begin: ae definition -->\n\n\n\n\n\n\n\n<!-- end: ae definition -->\n\n## While you wait...\n\n::: appex\n-   Go to your `ae` project in RStudio.\n\n-   Make sure all of your changes up to this point are committed and pushed, i.e., there's nothing left in your Git pane.\n\n-   Click Pull to get today's application exercise file: *ae\\-08\\-age\\-gaps\\-sales\\-import\\.qmd*.\n\n-   Wait till the you're prompted to work on the application exercise during class before editing the file.\n:::\n\n::: callout-note\n## AEs are due by the end of class\n\nSuccessful completion means at least one commit + push by 2PM today.\n:::\n\n# That pesky midterm...\n\n## Midterm Exam 1\n\nWorth 20% of your final grade; consists of two parts:\n\n-   **In-class**: worth 70% of the Midterm 1 grade;\n\n    -   Thursday February 20 11:45 AM - 1:00 PM\n\n-   **Take-home**: worth 30% of the Midterm 1 grade.\n\n    -   Released Thursday February 20 at 1:00 PM;\n    -   Due Monday February 24 at 8:30 AM.\n\n## In-class\n\n::: incremental\n-   All multiple choice;\n\n-   You will take it in Bio Sciences 111 (this room) or Physics 128;\n\n-   You get both sides of one 8.5\" x 11\" note sheet that you and only you created (written, typed, iPad, etc);\n\n-   If you do better on the final than you do on this, the final exam score will replace this.\n:::\n\n. . .\n\n::: callout-important\nIf you have testing accommodations, make sure I get proper documentation from SDAO and make appointments in the Testing Center by Friday. The appointment should overlap substantially with our class time if possible.\n:::\n\n## Example in-class question\n\nWhich command will replace a pre-existing column in a data frame with a new and improved version of itself?\n\na.  `group_by`\nb.  `summarize`\nc.  `pivot_wider`\nd.  `geom_replace`\ne.  `mutate`\n\n## Example in-class question\n\n\n\n::: {.cell}\n\n:::\n\n\n\n::: columns\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 2\n      x y      \n  <dbl> <chr>  \n1     1 John   \n2     2 John   \n3     3 Cameron\n4     4 Zito   \n5     5 Zito   \n6     6 Zito   \n```\n\n\n:::\n:::\n\n\n:::\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |>\n  group_by(y) |>\n  summarize(xbar = mean(x))\n```\n:::\n\n\n\nHow many rows will this output have?\n\na.  1\nb.  2\nc.  3\nd.  6\ne.  11\n:::\n:::\n\n## Example in-class question {.scrollable}\n\n::: columns\n::: {.column width=\"50%\"}\nWhich box plot is visualizing the same data as the histogram?\n:::\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](09-importing-recoding-data_files/figure-revealjs/unnamed-chunk-5-1.png){width=960}\n:::\n:::\n\n\n:::\n:::\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](09-importing-recoding-data_files/figure-revealjs/unnamed-chunk-6-1.png){width=960}\n:::\n:::\n\n\n\n## What should I put on my cheat sheet?\n\n. . .\n\n[**Ask one of our undergrad TAs!**](https://edstem.org/us/courses/70595/discussion/6137999) They took the class. I didn't.\n\n::: incremental\n-   description of common functions;\n-   description of different visualizations: how to interpret, and what to use when;\n-   doodles;\n-   cute words of affirmation.\n:::\n\n. . .\n\n::: callout-warning\nDon't waste space on the details of any specific applications or datasets we've seen (penguins, Bechdel, gerrymandering, midwest, etc). Anything we want you to know about a particular application will be introduced from scratch within the exam.\n:::\n\n## Take-home\n\n::: incremental\n-   It will be just like a lab, only shorter;\n-   Completely open-resource, but citation policies apply;\n-   Absolutely no collaboration of any kind;\n-   Seek help by posting *privately* on Ed;\n-   Submit your final PDF to Gradescope in the usual way.\n:::\n\n## Reminder: conduct policies\n\n::: incremental\n-   Uncited use of outside resources or inappropriate collaboration will result in a zero and be referred to the conduct office;\n-   If a conduct violation of any kind is discovered, your final letter grade in the course will be permanently reduced (A- down to B+, B+ down to B, etc);\n-   If folks share solutions, all students involved will be penalized equally, the sharer the same as the recipient.\n:::\n\n. . .\n\n::: callout-warning\n## It's not personal.\n\nThese policies apply to everyone. I don't care who your parents are, or what medical schools you are applying to in the fall. Grow up and act right.\n:::\n\n## Things you can do to study\n\n::: incremental\n-   **Practice problems**: released Thursday February 13;\n-   **Attend lab**: review game on Monday February 17;\n-   **Old labs**: correct parts where you lost points;\n-   **Old AEs**: complete tasks we didn't get to and compare with key;\n-   **Code along**: watch these videos specifically;\n-   **Textbook**: odd-numbered exercises in the back of Chs. 1, 4, 5, 6.\n:::\n\n# Let's zoom out for a sec...\n\n## Data science and statistical thinking\n\nBefore Midterm 1...\n\n-   **Data science**: the real-world *art* of transforming messy, imperfect, incomplete data into knowledge;\n\nAfter Midterm 1...\n\n-   **Statistics**: the mathematical discipline of quantifying our uncertainty about that knowledge.\n\n## Data science {.medium}\n\n![](images/00/data-science-cycle.001.png){fig-align=\"center\"}\n\n## Data science {.medium}\n\n::: incremental\n1.  **Collection**: we won't seriously study this!\n\n    -   **for us**: data importing (`read_csv`), and webscraping (next time);\n    -   **but really**: domain-specific issues of measurement, survey design, experimental design, etc;\n:::\n\n## From last time: data collection\n\nI sent out my lil' survey with Google Forms, downloaded the responses in a CSV, and read that sucker in:\n\n::: columns\n::: {.column width=\"35%\"}\n<iframe src=\"https://docs.google.com/forms/d/e/1FAIpQLSf0x7gOZY04c9vzdyIdm-v_vCqL0oFaQI9-LWB8Dt3uf3TriQ/viewform?embedded=true\" width=\"350\" height=\"400\" frameborder=\"0\" marginheight=\"0\" marginwidth=\"0\">\n\nLoading…\n\n</iframe>\n:::\n\n::: {.column width=\"65%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsurvey <- read_csv(\"data/survey-2025-02-06.csv\")\nsurvey\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 209 × 3\n   Timestamp         How many classes do you have on Tues…¹ `What year are you?`\n   <chr>             <chr>                                  <chr>               \n 1 2/6/2025 11:33:57 3                                      Sophomore           \n 2 2/6/2025 11:37:39 3                                      First-year          \n 3 2/6/2025 11:40:55 2                                      Senior              \n 4 2/6/2025 11:42:05 3                                      First-year          \n 5 2/6/2025 11:42:46 3                                      Senior              \n 6 2/6/2025 11:43:28 3                                      Senior              \n 7 2/6/2025 11:44:41 3                                      First-year          \n 8 2/6/2025 11:44:49 3                                      First-year          \n 9 2/6/2025 11:44:51 2                                      Sophomore           \n10 2/6/2025 11:44:51 3                                      Sophomore           \n# ℹ 199 more rows\n# ℹ abbreviated name: ¹​`How many classes do you have on Tuesdays?`\n```\n\n\n:::\n:::\n\n\n:::\n:::\n\n## Data science {.medium}\n\n1.  **Collection**: we won't seriously study this!\n\n    -   **for us**: data importing (`read_csv`), and webscraping (next time);\n    -   **but really**: domain-specific issues of measurement, survey design, experimental design, etc;\n\n::: incremental\n2.  **Preparation**: cleaning, wrangling, and otherwise *tidying* the data so we can actually work with it.\n\n    -   **keywords**: `mutate`, `fct_relevel`, `pivot_*`, `*_join`\n:::\n\n## From last time: data preparation {.scrollable}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsurvey <- survey |>\n  rename(\n    tue_classes = `How many classes do you have on Tuesdays?`,\n    year = `What year are you?`\n  ) |>\n  mutate(\n    tue_classes = case_when(\n      tue_classes == \"2 -3\" ~ \"3\",\n      tue_classes == \"3 classes\" ~ \"3\",\n      tue_classes == \"Four\" ~ \"4\",\n      tue_classes == \"TWO MANY\" ~ \"2\",\n      tue_classes == \"Three\" ~ \"3\",\n      tue_classes == \"Two\" ~ \"2\",\n      tue_classes == \"Two plus a chemistry lab\" ~ \"3\",\n      tue_classes == \"three\" ~ \"3\",\n      .default = tue_classes\n    ),\n    tue_classes = as.numeric(tue_classes),\n    year = fct_relevel(year, \"First-year\", \"Sophomore\", \"Junior\", \"Senior\")\n  ) |>\n  select(tue_classes, year)\nsurvey\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 209 × 2\n   tue_classes year      \n         <dbl> <fct>     \n 1           3 Sophomore \n 2           3 First-year\n 3           2 Senior    \n 4           3 First-year\n 5           3 Senior    \n 6           3 Senior    \n 7           3 First-year\n 8           3 First-year\n 9           2 Sophomore \n10           3 Sophomore \n# ℹ 199 more rows\n```\n\n\n:::\n:::\n\n\n\n## Data science {.medium}\n\n1.  **Collection**: we won't seriously study this!\n\n    -   **for us**: data importing (`read_csv`), and webscraping (next time);\n    -   **but really**: domain-specific issues of measurement, survey design, experimental design, etc;\n\n2.  **Preparation**: cleaning, wrangling, and otherwise *tidying* the data so we can actually work with it.\n\n    -   **keywords**: `mutate`, `fct_relevel`, `pivot_*`, `*_join`\n\n::: incremental\n3.  **Analysis**: finally transform the data into *knowledge*...\n\n    -   **pictures**: `ggplot`, `geom_*`, etc\n    -   **numerical summaries**: `summarize`, `group_by`, `count`, `mean`, `median`, `sd`, `quantile`, `IQR`, `cor`, etc\n:::\n\n## From last time: data analysis\n\nA human being can learn nothing from staring at this box:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsurvey\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 209 × 2\n   tue_classes year      \n         <dbl> <fct>     \n 1           3 Sophomore \n 2           3 First-year\n 3           2 Senior    \n 4           3 First-year\n 5           3 Senior    \n 6           3 Senior    \n 7           3 First-year\n 8           3 First-year\n 9           2 Sophomore \n10           3 Sophomore \n# ℹ 199 more rows\n```\n\n\n:::\n:::\n\n\n\n## From last time: data analysis\n\nPicture!\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(survey, aes(x = tue_classes, fill = year)) + \n  geom_bar(position = \"dodge\")\n```\n\n::: {.cell-output-display}\n![](09-importing-recoding-data_files/figure-revealjs/unnamed-chunk-10-1.png){width=960}\n:::\n:::\n\n\n\n## From last time: data analysis\n\nBetter picture?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(survey, aes(x = tue_classes, fill = year)) + \n  geom_bar(position = \"fill\")\n```\n\n::: {.cell-output-display}\n![](09-importing-recoding-data_files/figure-revealjs/unnamed-chunk-11-1.png){width=960}\n:::\n:::\n\n\n\n## From last time: data analysis\n\nNumbers!\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsurvey |>\n  count(tue_classes, year) |>\n  group_by(tue_classes) |>\n  mutate(prop = n / sum(n))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 17 × 4\n# Groups:   tue_classes [5]\n   tue_classes year           n   prop\n         <dbl> <fct>      <int>  <dbl>\n 1           1 Sophomore      4 0.4   \n 2           1 Junior         4 0.4   \n 3           1 Senior         2 0.2   \n 4           2 First-year    25 0.439 \n 5           2 Sophomore     19 0.333 \n 6           2 Junior         9 0.158 \n 7           2 Senior         4 0.0702\n 8           3 First-year    47 0.427 \n 9           3 Sophomore     46 0.418 \n10           3 Junior         9 0.0818\n11           3 Senior         8 0.0727\n12           4 First-year    18 0.621 \n13           4 Sophomore      9 0.310 \n14           4 Junior         1 0.0345\n15           4 Senior         1 0.0345\n16           5 First-year     2 0.667 \n17           5 Sophomore      1 0.333 \n```\n\n\n:::\n:::\n\n\n\n## Data science {.medium}\n\n1.  **Collection**: we won't seriously study this!\n\n    -   **for us**: data importing (`read_csv`), and webscraping (next time);\n    -   **but really**: domain-specific issues of measurement, survey design, experimental design, etc;\n\n2.  **Preparation**: cleaning, wrangling, and otherwise *tidying* the data so we can actually work with it.\n\n    -   **keywords**: `mutate`, `fct_relevel`, `pivot_*`, `*_join`\n\n3.  **Analysis**: finally transform the data into *knowledge*...\n\n    -   **pictures**: `ggplot`, `geom_*`, etc\n    -   **numerical summaries**: `summarize`, `group_by`, `count`, `mean`, `median`, `sd`, `quantile`, `iqr`, `cor`, etc\n\n. . .\n\nThe pictures and the summaries need to work together!\n\n## A cautionary tale: Anscombe's quartet\n\n\n\n::: {.cell}\n\n:::\n\n\n\n::: columns\n::: {.column width=\"25%\"}\nDataset I\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n    x     y\n1  10  8.04\n2   8  6.95\n3  13  7.58\n4   9  8.81\n5  11  8.33\n6  14  9.96\n7   6  7.24\n8   4  4.26\n9  12 10.84\n10  7  4.82\n11  5  5.68\n```\n\n\n:::\n:::\n\n\n:::\n\n::: {.column width=\"25%\"}\nDataset II\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n    x    y\n1  10 9.14\n2   8 8.14\n3  13 8.74\n4   9 8.77\n5  11 9.26\n6  14 8.10\n7   6 6.13\n8   4 3.10\n9  12 9.13\n10  7 7.26\n11  5 4.74\n```\n\n\n:::\n:::\n\n\n:::\n\n::: {.column width=\"25%\"}\nDataset III\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n    x     y\n1  10  7.46\n2   8  6.77\n3  13 12.74\n4   9  7.11\n5  11  7.81\n6  14  8.84\n7   6  6.08\n8   4  5.39\n9  12  8.15\n10  7  6.42\n11  5  5.73\n```\n\n\n:::\n:::\n\n\n:::\n\n::: {.column width=\"25%\"}\nDataset IV\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n    x     y\n1   8  6.58\n2   8  5.76\n3   8  7.71\n4   8  8.84\n5   8  8.47\n6   8  7.04\n7   8  5.25\n8  19 12.50\n9   8  5.56\n10  8  7.91\n11  8  6.89\n```\n\n\n:::\n:::\n\n\n:::\n:::\n\n## A cautionary tale: Anscombe's quartet\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(anscombe_tidy, aes(x, y)) +\n  geom_point() +\n  facet_wrap(~ set) \n```\n\n::: {.cell-output-display}\n![](09-importing-recoding-data_files/figure-revealjs/unnamed-chunk-18-1.png){width=960}\n:::\n:::\n\n\n\n## A cautionary tale: Anscombe's quartet\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(anscombe_tidy, aes(x, y)) +\n  geom_point() +\n  facet_wrap(~ set) +\n  geom_smooth(method = \"lm\", se = FALSE)\n```\n\n::: {.cell-output-display}\n![](09-importing-recoding-data_files/figure-revealjs/unnamed-chunk-19-1.png){width=960}\n:::\n:::\n\n\n\n## If you only looked at summary statistics...\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanscombe_tidy |>\n  group_by(set) |>\n  summarize(\n    xbar = mean(x),\n    ybar = mean(y),\n    sx = sd(x),\n    sy = sd(y),\n    r = cor(x, y)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 6\n  set    xbar  ybar    sx    sy     r\n  <chr> <dbl> <dbl> <dbl> <dbl> <dbl>\n1 I         9  7.50  3.32  2.03 0.816\n2 II        9  7.50  3.32  2.03 0.816\n3 III       9  7.5   3.32  2.03 0.816\n4 IV        9  7.50  3.32  2.03 0.817\n```\n\n\n:::\n:::\n\n\n\n## Our motto: ABV! {.large}\n\n. . .\n\nNo, not alcohol by volume...\n\n::: columns\n::: {.column width=\"20%\"}\n::: incremental\n-   `A`lways!\n-   `B`e!\n-   `V`isualizing!\n:::\n:::\n\n::: {.column .fragment width=\"70%\"}\n![](images/09/ggr.jpg){fig-align=\"right\" width=\"80%\"}\n:::\n:::\n\n# From last time\n\n## Finish up: `ae-08-durham-climate-factors`\n\n::: appex\n-   Go to your ae project in RStudio.\n\n-   Open `ae-08-durham-climate-factors.qmd` and pick up at \"Recode and reorder\".\n:::\n\n# Reading data into R\n\n## Reading rectangular data\n\n-   Using [**readr**](https://readr.tidyverse.org/):\n    -   Most commonly: `read_csv()`\n    -   Maybe also: `read_tsv()`, `read_delim()`, etc.\n\n. . .\n\n-   Using [**readxl**](https://readxl.tidyverse.org/): `read_excel()`\n\n. . .\n\n-   Using [**googlesheets4**](https://googlesheets4.tidyverse.org/): `read_sheet()` -- We haven't covered this in the videos, but might be useful for your projects\n\n# Application exercise\n\n## Goal 1: Reading and writing CSV files\n\n-   Read a CSV file\n\n-   Split it into subsets based on features of the data\n\n-   Write out subsets as CSV files\n\n## Age gap in Hollywood relationships {.smaller}\n\n::: columns\n::: {.column width=\"25%\"}\n::: question\nWhat is the story in this visualization?\n:::\n:::\n\n::: {.column width=\"75%\"}\n![](images/09/hollywood-ages.jpeg){fig-align=\"center\" width=\"600\"}\n:::\n:::\n\n## ae\\-08\\-age\\-gaps\\-sales\\-import - Part 1 {.smaller}\n\n::: appex\n-   Go to your ae project in RStudio.\n\n-   If you haven't yet done so, make sure all of your changes up to this point are committed and pushed, i.e., there's nothing left in your Git pane.\n\n-   If you haven't yet done so, click Pull to get today's application exercise file: *ae\\-08\\-age\\-gaps\\-sales\\-import\\.qmd*.\n\n-   Work through **Part 1** of the application exercise in class, and render, commit, and push your edits.\n:::\n\n## Goal 2: Reading Excel files\n\n-   Read an Excel file with non-tidy data\n\n-   Tidy it up!\n\n## Sales data\n\n![](images/09/sales-excel.png)\n\n. . .\n\n::: question\nAre these data tidy? Why or why not?\n:::\n\n## Sales data\n\n::: question\nWhat \"data moves\" do we need to go from the original, non-tidy data to this, tidy one?\n:::\n\n![](images/09/sales-2.png){width=\"150\"}\n\n## ae\\-08\\-age\\-gaps\\-sales\\-import - Part 2 {.smaller}\n\n::: appex\n-   Go to your ae project in RStudio.\n\n-   If you haven't yet done so, make sure all of your changes up to this point are committed and pushed, i.e., there's nothing left in your Git pane.\n\n-   If you haven't yet done so, click Pull to get today's application exercise file: *ae\\-08\\-age\\-gaps\\-sales\\-import\\.qmd*.\n\n-   Work through **Part 2** of the application exercise in class, and render, commit, and push your edits.\n:::\n",
    "supporting": [
      "09-importing-recoding-data_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}