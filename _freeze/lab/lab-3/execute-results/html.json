{
  "hash": "d8f9749197c7d2aad0f97e6d44e66884",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Lab 3\nsubtitle: Inflation everywhere\ncategories: Lab\ndescription: \"Due Monday February 10 at 8:30 AM\"\n---\n\n\n\n# Introduction\n\nThis lab gives you more practice with data wrangling and data pipelines, with an emphasis on mastering the subtleties of `group_by`, as well as introducing pivoting to the mix.\n\n::: callout-note\nThis lab assumes you've completed the labs so far and doesn't repeat setup and overview content from those labs. If you have not yet done those, you should go back and review the previous labs before starting on this one.\n:::\n\n## Learning objectives\n\nBy the end of the lab, you will...\n\n-   Be able to pivot/reshape data using `tidyr`\n-   Continue developing your data wrangling skills using `dplyr`\n-   Build on your mastery of data visualizations using `ggplot2`\n-   Get more experience with data science workflow using R, RStudio, Git, and GitHub\n-   Further your reproducible authoring skills with Quarto\n-   Improve your familiarity with version control using Git and GitHub\n\n## Getting started\n\nLog in to RStudio, clone your `lab-3` repo from GitHub, open your `lab-3.qmd` document, and get started!\n\n::: {.callout-tip collapse=\"true\"}\n## Click here if you prefer to see step-by-step instructions\n\n### Step 1: Log in to RStudio\n\n-   Go to <https://cmgr.oit.duke.edu/containers> and log in with your Duke NetID and Password.\n-   Click `STA198-199` under My reservations to log into your container. You should now see the RStudio environment.\n\n### Step 2: Clone the repo & start new RStudio project\n\n-   Go to the course organization at [github.com/sta199-s25](https://github.com/sta199-s25) organization on GitHub. Click on the repo with the prefix **lab-3**. It contains the starter documents you need to complete the lab.\n\n-   Click on the green **CODE** button, select **Use SSH** (this might already be selected by default, and if it is, you'll see the text **Clone with SSH**). Click on the clipboard icon to copy the repo URL.\n\n-   In RStudio, go to *File* ➛ *New Project* ➛*Version Control* ➛ *Git*.\n\n-   Copy and paste the URL of your assignment repo into the dialog box *Repository URL*. Again, please make sure to have *SSH* highlighted under *Clone* when you copy the address.\n\n-   Click *Create Project*, and the files from your GitHub repo will be displayed in the *Files* pane in RStudio.\n\n-   Click *lab-3.qmd* to open the template Quarto file. This is where you will write up your code and narrative for the lab.\n\n### Step 3: Update the YAML\n\nIn `lab-3.qmd`, update the `author` field to your name, render your document and examine the changes. Then, in the Git pane, click on **Diff** to view your changes, add a commit message (e.g., \"Added author name\"), and click **Commit**. Then, push the changes to your GitHub repository, and in your browser confirm that these changes have indeed propagated to your repository.\n:::\n\n::: callout-important\nIf you run into any issues with the first steps outlined above, flag a TA for help before proceeding.\n:::\n\n## Packages\n\nIn this lab we will work with the **tidyverse** package, which is a collection of packages for doing data analysis in a \"tidy\" way.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n\n-   **Run** the code cell by clicking on the green triangle (play) button for the code cell labeled `load-packages`. This loads the package to make its features (the functions and datasets in it) be accessible from your *Console*.\n-   Then, **render** the document which loads this package to make its features (the functions and datasets in it) be available for other code cells in your Quarto document.\n\n## Guidelines\n\n\nAs we've discussed in lecture, your plots should include an informative title, axes and legends should have human-readable labels, and careful consideration should be given to aesthetic choices.\n\nAdditionally, code should follow the [tidyverse style](https://style.tidyverse.org/).\nParticularly,\n\n-   there should be spaces before and line breaks after each `+` when building a `ggplot`,\n\n-   there should also be spaces before and line breaks after each `|>` in a data transformation pipeline,\n\n-   code should be properly indented,\n\n-   there should be spaces around `=` signs and spaces after commas.\n\nFurthermore, all code should be visible in the PDF output, i.e., should not run off the page on the PDF.\nLong lines that run off the page should be split across multiple lines with line breaks.\n\n::: callout-important\nContinuing to develop a sound workflow for reproducible data analysis is important as you complete the lab and other assignments in this course.\nThere will be periodic reminders in this assignment to remind you to **render, commit, and push** your changes to GitHub.\nYou should have at least 3 commits with meaningful commit messages by the end of the assignment.\n:::\n\n\n\n# Questions\n\n## Part 1\n\n**All about `group_by()`!**\n\nUse the following data frame for Question 1 and Question 2:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- tibble(\n  var_1 = c(50, 20, 70, 10, 100, 30, 40, 80, 120, 60, 90, 110),\n  var_2 = c(\"Pizza\", \"Burger\", \"Pizza\", \"Pizza\", \"Burger\", \"Burger\",\n            \"Burger\", \"Pizza\", \"Burger\", \"Pizza\", \"Pizza\", \"Burger\"),\n  var_3 = c(\"Apple\", \"Apple\", \"Pear\", \"Banana\", \"Pear\", \"Banana\",\n            \"Apple\", \"Apple\", \"Pear\", \"Pear\", \"Banana\", \"Banana\")\n)\n\ndf\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 12 × 3\n   var_1 var_2  var_3 \n   <dbl> <chr>  <chr> \n 1    50 Pizza  Apple \n 2    20 Burger Apple \n 3    70 Pizza  Pear  \n 4    10 Pizza  Banana\n 5   100 Burger Pear  \n 6    30 Burger Banana\n 7    40 Burger Apple \n 8    80 Pizza  Apple \n 9   120 Burger Pear  \n10    60 Pizza  Pear  \n11    90 Pizza  Banana\n12   110 Burger Banana\n```\n\n\n:::\n:::\n\n\n\n### Question 1\n\nGrouping by a single variable.\n\na\\. What does the following code chunk do? Run it, analyze the result, and articulate in words what `arrange()` does.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |>\n  arrange(var_2)\n```\n:::\n\n\n\nb\\. What does the following code chunk do? Run it, analyze the result, and articulate in words what `group_by()` does. Also, comment on how it's different from the `arrange()` in part (b).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |>\n  group_by(var_2)\n```\n:::\n\n\n\nc\\. What does the following code chunk do? Run it, analyze the result, and articulate in words what the pipeline does.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |>\n  group_by(var_2) |>\n  summarize(mean_var_1 = mean(var_1))\n```\n:::\n\n\n\nd\\. Compare this behavior to the following code chunk. Run it, analyze the result, and articulate in words what the pipeline does, and how it's behavior is different from part (c).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |>\n  summarize(mean_var_1 = mean(var_1))\n```\n:::\n\n\n\n### Question 2\n\nGrouping by two variables.\n\na\\. How many levels does `var_2` have? How many levels does `var_3` have? How many possible combinations are there of the levels of `var_2` and `var_3`?\n\nb\\. Write some code that uses basic arithmetic operations to manually compute the average value of `var_1` among all the rows that have Burger-Apple. Do the same thing for the rows that have Burger-Banana.\n\nc\\. You're probably sick of that, right? What does the following code chunk do? Run it, analyze the result, and articulate in words what the pipeline does and how it compared to part (b). Then, comment on what the message says.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |>\n  group_by(var_2, var_3) |>\n  summarize(mean_var_1 = mean(var_1))\n```\n:::\n\n\n\nd\\. What does the following code chunk do? Run it, analyze the result, and articulate in words what the pipeline does, especially mentioning what the `.groups` argument does. How is the output different from the one in part (c)?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |>\n  group_by(var_2, var_3) |>\n  summarize(mean_var_1 = mean(var_1), .groups = \"drop\")\n```\n:::\n\n\n\ne\\. What do the following pipelines do? Run both, analyze their results, and articulate in words what each pipeline does. How are the outputs of the two pipelines different?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |>\n  group_by(var_2, var_3) |>\n  summarize(mean_var_1 = mean(var_1), .groups = \"drop\")\n\ndf |>\n  group_by(var_2, var_3) |>\n  mutate(mean_var_1 = mean(var_1))\n```\n:::\n\n\n\n::: render-commit-push\nRender, commit, and push your changes to GitHub with the commit message \"Added answers for Questions 1 and 2\".\n\nMake sure to commit and push all changed files so that your Git pane is empty afterward.\n:::\n\n## Part 2\n\n**Inflation across the world**\n\nFor this part of the analysis you will work with inflation data from various countries in the world over the last 30 years.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncountry_inflation <- read_csv(\"data/country-inflation.csv\")\n```\n:::\n\n\n\n### Question 3\n\nGet to know the data.\n\na.  `glimpse()` at the `country_inflation` data frame and answer the following questions based on the output. How many rows does `country_inflation` have and what does each row represent? How many columns does `country_inflation` have and what does each column represent?\n\nb.  Display a list of the unique countries included in the dataset. *Hint:* Another word for \"unique\" is `distinct()`.\n\n::: callout-tip\nA function that can be useful for part (b) is `pull()`. Check out its documentation for examples of usage.\n:::\n\n### Question 4\n\nWhich countries had the top three highest inflation rates in 2023? Your output should be a data frame with two columns, `country` and `2023`, with inflation rates in descending order, and three rows for the top three countries. Briefly comment on how the inflation rates for these countries compare to the inflation rate for United States in that year.\n\n::: callout-tip\n## Tips\n\n-   You might find the command `slice_head` helpful here.\n-   Column names that are numbers are not considered \"proper\" in R, therefore to select them you'll need to surround them with backticks, e.g. `` select( ` 1993 ` ) ``.\n:::\n\n### Question 5\n\nIn a single pipeline,\n\n-   calculate the ratio of the inflation in 2023 and inflation in 1993 for each country and store this information in a new column called `inf_ratio`,\n-   select the variables `country` and `inf_ratio`, and\n-   store the result in a new data frame called `country_inflation_ratios`.\n\nThen, in two separate pipelines,\n\n-   arrange `country_inflation_ratios` in increasing order of `inf_ratio` and\n-   arrange `country_inflation_ratios` in decreasing order of `inf_ratio`.\n\nWhich country’s inflation increase is the largest over this time period and by how much? Which country’s inflation decrease is the largest over this time period and by how much?\n\n::: callout-tip\nFor this question you'll once again need to use variables whose names are numbers (years) in your pipeline. Make sure to surround the names of such variables with backticks (`` ` ``).\n:::\n\n### Question 6\n\nReshape (pivot) `country_inflation` such that each row represents a country/year combination, with columns `country`, `year`, and `annual_inflation`. Then, display the resulting data frame and state how many rows and columns it has.\n\nRequirements:\n\n-   Your code must use one of `pivot_longer()` or `pivot_wider()`. There are other ways you can do this reshaping move in R, but this question requires solving this problem by pivoting.\n-   In your `pivot_*()` function, you must use `names_transform = as.numeric` as an argument to transform the variable type to numeric as you pivot the data so that in the resulting data frame the year variable is numeric.\n-   The resulting data frame must be saved as something other than `country_inflation` so you (1) can refer to this data frame later in your analysis and (2) do not overwrite `country_inflation`. Use a short but informative name.\n\n::: callout-important\nThe remaining questions require the use of the pivoted data frame.\n:::\n\n::: render-commit-push\nIf you haven't yet done so, now is a good time to render, commit, and push. Make sure that you commit and push all changed documents and your Git pane is completely empty before proceeding.\n:::\n\n### Question 7\n\nUse a separate, single pipeline to answer each of the following questions.\n\nRequirement: Your code must use the `filter()` function for each part, not `arrange()`.\n\na.  What is the highest inflation rate observed between 1993 and 2023? The output of the pipeline should be a data frame with one row and three columns. In addition to code and output, your response should include a single sentence stating the country and year.\n\nb.  What is the lowest inflation rate observed between 1993 and 2023? The output of the pipeline should be a data frame with one row and three columns. In addition to code and output, your response should include a single sentence stating the country and year.\n\nc.  Putting (a) and (b) together: What are the highest and the lowest inflation rates observed between 1993 and 2023? The output of the pipeline should be a data frame with two rows and three columns.\n\n### Question 8\n\na\\. Create a vector called `countries_of_interest` which contains the names of up to five countries you want to visualize the inflation rates for over the years. For example, if these countries are Türkiye and United States, you can express this as follows:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncountries_of_interest <- c(\"Türkiye\", \"United States\")\n```\n:::\n\n\n\nIf they are Türkiye, United States, and Chile, you can express this as follows:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncountries_of_interest <- c(\n  \"Türkiye\", \"United States\", \"Chile\"\n)\n```\n:::\n\n\n\nSo on and so forth... Then, in 1-2 sentences, state why you chose these countries.\n\n::: callout-note\nYour `countries_of_interest` should consist of no more than five countries. Make sure that the spelling of your countries matches how they appear in the dataset.\n:::\n\nb\\. In a single pipeline, filter your reshaped dataset to include only the `countries_of_interest` from part (a), and save the resulting data frame with a new name so you (1) can refer to this data frame later in your analysis and (2) do not overwrite the data frame you're starting with. Use a short but informative name. Then, in a new pipeline, find the `distinct()` countries in the data frame you created.\n\n::: callout-tip\nThe number of distinct countries in the filtered data frame you created in part (b) should equal the number of countries you chose in part (a). If it doesn't, you might have misspelled a country name or made a mistake in filtering for these countries. Go back and correct your work.\n:::\n\n### Question 9\n\nUsing your data frame from the previous question, create a plot of annual inflation vs. year for these countries. Then, in a few sentences, describe the patterns you observe in the plot, particularly focusing on anything you find surprising or not surprising, based on your knowledge (or lack thereof) of these countries economies.\n\nRequirements for the plot:\n\n-   Data should be represented with points as well as lines connecting the points for each country.\n-   Each country should be represented by a different color line and different color and shape points.\n-   Axes and legend should be properly labeled.\n-   The plot should have an appropriate title (and optionally a subtitle).\n-   Plot should be customized in at least one way – you could use a different than default color scale, or different than default theme, or some other customization.\n\n::: render-commit-push\nNow is another good time to render, commit, and push. Make sure that you commit and push all changed documents and your Git pane is completely empty before proceeding.\n:::\n\n# Wrap-up\n\n## Submission\n\nOnce you are finished with the lab, you will submit your final PDF document to Gradescope.\n\n::: callout-warning\nBefore you wrap up the assignment, make sure all of your documents are updated on your GitHub repo. We will be checking these to make sure you have been practicing how to commit and push changes.\n\nYou must turn in a PDF file to the Gradescope page by the submission deadline to be considered \"on time\".\n:::\n\nTo submit your assignment:\n\n-   Go to <http://www.gradescope.com> and click *Log in* in the top right corner.\n-   Click *School Credentials* $\\rightarrow$ *Duke NetID* and log in using your NetID credentials.\n-   Click on your *STA 199* course.\n-   Click on the assignment, and you'll be prompted to submit it.\n-   Mark all the pages associated with question. All the pages of your lab should be associated with at least one question (i.e., should be \"checked\").\n\n::: callout-important\n## Checklist\n\nMake sure you have:\n\n-   attempted all questions\n-   rendered your Quarto document\n-   committed and pushed everything to your GitHub repository such that the Git pane in RStudio is empty\n-   uploaded your PDF to Gradescope\n-   selected pages associated with each question on Gradescope\n:::\n\n## Grading and feedback\n\n-   Some of the questions will be graded for accuracy.\n\n-   Some will be graded for completion.\n\n-   There are also workflow points:\n\n    -   for coding style;\n    -   for committing at least three times as you work through your lab;\n    -   for pushing your final rendered PDF into your lab repo before the deadline (in addition to uploading it to Gradescope);\n    -   for overall organization.\n\n-   You'll receive feedback on your lab on Gradescope within a week.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}