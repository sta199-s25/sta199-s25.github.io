{
  "hash": "a1d4aad7a72febe5dafd9ab79dc7649e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"AE 06: Sales taxes + data joining\"\nsubtitle: \"Suggested answers\"\n---\n\n\n\n::: callout-important\nThese are suggested answers. This document should be used as a reference only; it's not designed to be an exhaustive key.\n:::\n\n## Getting started\n\n### Packages\n\nWe'll use the **tidyverse** package for this analysis.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n\n### Data\n\nThe data are available in the `data` folder:\n\n-   `sales-taxes.csv`\n\n-   `us-regions.csv`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsales_taxes <- read_csv(\"data/sales-taxes.csv\")\nus_regions <- read_csv(\"data/us-regions.csv\")\n```\n:::\n\n\n\nAnd let's take a look at the data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(sales_taxes)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 51\nColumns: 5\n$ state              <chr> \"Alabama\", \"Alaska\", \"Arizona\", \"Arkansas\", \"Califo…\n$ state_tax_rate     <dbl> 0.0400, 0.0000, 0.0560, 0.0650, 0.0725, 0.0290, 0.0…\n$ avg_local_tax_rate <dbl> 0.0529, 0.0182, 0.0278, 0.0295, 0.0160, 0.0491, 0.0…\n$ combined_rate      <dbl> 0.0929, 0.0182, 0.0838, 0.0945, 0.0885, 0.0781, 0.0…\n$ max_local_tax_rate <dbl> 0.0750, 0.0785, 0.0530, 0.0613, 0.0475, 0.0830, 0.0…\n```\n\n\n:::\n\n```{.r .cell-code}\nglimpse(us_regions)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 50\nColumns: 2\n$ state_name <chr> \"Maine\", \"New Hampshire\", \"Vermont\", \"Massachusetts\", \"Rhod…\n$ region     <chr> \"Northeast\", \"Northeast\", \"Northeast\", \"Northeast\", \"Northe…\n```\n\n\n:::\n:::\n\n\n\n## Sales tax in swing states: `if_else`\n\nCreate new `swing_state` variable using `if_else`:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlist_of_swing_states <- c(\"Arizona\", \"Georgia\", \"Michigan\", \"Nevada\", \n                          \"North Carolina\", \"Pennsylvania\", \"Wisconsin\")\n\nsales_taxes <- sales_taxes |>\n  mutate(\n    swing_state = if_else(state %in% list_of_swing_states,\n                          \"Swing\",\n                          \"Non-swing\")) |>\n  relocate(swing_state)\n\nsales_taxes\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 51 × 6\n   swing_state state       state_tax_rate avg_local_tax_rate combined_rate\n   <chr>       <chr>                <dbl>              <dbl>         <dbl>\n 1 Non-swing   Alabama             0.04               0.0529        0.0929\n 2 Non-swing   Alaska              0                  0.0182        0.0182\n 3 Swing       Arizona             0.056              0.0278        0.0838\n 4 Non-swing   Arkansas            0.065              0.0295        0.0945\n 5 Non-swing   California          0.0725             0.016         0.0885\n 6 Non-swing   Colorado            0.029              0.0491        0.0781\n 7 Non-swing   Connecticut         0.0635             0             0.0635\n 8 Non-swing   Delaware            0                  0             0     \n 9 Non-swing   Florida             0.06               0.01          0.07  \n10 Swing       Georgia             0.04               0.0338        0.0738\n# ℹ 41 more rows\n# ℹ 1 more variable: max_local_tax_rate <dbl>\n```\n\n\n:::\n:::\n\n\n\nSummarize to find the mean sales tax in each type of state:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsales_taxes |>\n  group_by(swing_state) |>\n  summarize(mean_state_tax = mean(state_tax_rate))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 2\n  swing_state mean_state_tax\n  <chr>                <dbl>\n1 Non-swing           0.0504\n2 Swing               0.0546\n```\n\n\n:::\n:::\n\n\n\n## Sales tax in coastal states: `case_when`\n\nCreate new `coast` variable using `case_when`:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacific_coast <- c(\"Alaska\", \"Washington\", \"Oregon\", \"California\", \"Hawaii\")\n\natlantic_coast <- c(\n  \"Connecticut\", \"Delaware\", \"Georgia\", \"Florida\", \"Maine\", \"Maryland\", \n  \"Massachusetts\", \"New Hampshire\", \"New Jersey\", \"New York\", \n  \"North Carolina\", \"Rhode Island\", \"South Carolina\", \"Virginia\"\n)\n\nsales_taxes <- sales_taxes |>\n  mutate(\n    coast = case_when(\n      state %in% pacific_coast ~ \"Pacific\",\n      state %in% atlantic_coast ~ \"Atlantic\",\n      .default = \"Neither\"\n    )\n  ) |>\n  relocate(coast)\n\nsales_taxes\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 51 × 7\n   coast    swing_state state    state_tax_rate avg_local_tax_rate combined_rate\n   <chr>    <chr>       <chr>             <dbl>              <dbl>         <dbl>\n 1 Neither  Non-swing   Alabama          0.04               0.0529        0.0929\n 2 Pacific  Non-swing   Alaska           0                  0.0182        0.0182\n 3 Neither  Swing       Arizona          0.056              0.0278        0.0838\n 4 Neither  Non-swing   Arkansas         0.065              0.0295        0.0945\n 5 Pacific  Non-swing   Califor…         0.0725             0.016         0.0885\n 6 Neither  Non-swing   Colorado         0.029              0.0491        0.0781\n 7 Atlantic Non-swing   Connect…         0.0635             0             0.0635\n 8 Atlantic Non-swing   Delaware         0                  0             0     \n 9 Atlantic Non-swing   Florida          0.06               0.01          0.07  \n10 Atlantic Swing       Georgia          0.04               0.0338        0.0738\n# ℹ 41 more rows\n# ℹ 1 more variable: max_local_tax_rate <dbl>\n```\n\n\n:::\n:::\n\n\n\nSummarize to find the mean sales tax in each type of state:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsales_taxes |>\n  group_by(coast) |>\n  summarize(mean_state_tax = mean(state_tax_rate))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 2\n  coast    mean_state_tax\n  <chr>             <dbl>\n1 Atlantic         0.0484\n2 Neither          0.0545\n3 Pacific          0.0355\n```\n\n\n:::\n:::\n\n\n\n## Sales tax in US regions: joining\n\nJoin the sales tax data with region data and save the joined data frame as a new data frame, not overwriting either data frame that goes into the join.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsales_taxes_regions <- sales_taxes |>\n  full_join(us_regions, \n            by = join_by(state == state_name)) |>\n  relocate(region)\n\nsales_taxes_regions\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 51 × 8\n   region    coast    swing_state state       state_tax_rate avg_local_tax_rate\n   <chr>     <chr>    <chr>       <chr>                <dbl>              <dbl>\n 1 South     Neither  Non-swing   Alabama             0.04               0.0529\n 2 West      Pacific  Non-swing   Alaska              0                  0.0182\n 3 West      Neither  Swing       Arizona             0.056              0.0278\n 4 South     Neither  Non-swing   Arkansas            0.065              0.0295\n 5 West      Pacific  Non-swing   California          0.0725             0.016 \n 6 West      Neither  Non-swing   Colorado            0.029              0.0491\n 7 Northeast Atlantic Non-swing   Connecticut         0.0635             0     \n 8 South     Atlantic Non-swing   Delaware            0                  0     \n 9 South     Atlantic Non-swing   Florida             0.06               0.01  \n10 South     Atlantic Swing       Georgia             0.04               0.0338\n# ℹ 41 more rows\n# ℹ 2 more variables: combined_rate <dbl>, max_local_tax_rate <dbl>\n```\n\n\n:::\n:::\n\n\n\nCalculate the average sales tax of states in each region. What is surprising in the output?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsales_taxes_regions |>\n  group_by(region) |>\n  summarize(mean_state_tax = mean(state_tax_rate))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 2\n  region    mean_state_tax\n  <chr>              <dbl>\n1 Midwest           0.0569\n2 Northeast         0.0530\n3 South             0.0523\n4 West              0.0416\n5 <NA>              0.06  \n```\n\n\n:::\n:::\n\n\n\nIdentify the state with `NA` for region.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsales_taxes_regions |>\n  filter(is.na(region)) |>\n  select(state)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 1\n  state               \n  <chr>               \n1 District of Columbia\n```\n\n\n:::\n:::\n\n\n\nApply a fix for the `NA` in region, and calculate the mean sales taxes for regions again. Display the results in ascending order of mean sales tax.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsales_taxes_regions |>\n  mutate(\n    region = if_else(state == \"District of Columbia\", \"Northeast\", region)\n  ) |>\n  group_by(region) |>\n  summarize(mean_state_tax = mean(state_tax_rate))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 2\n  region    mean_state_tax\n  <chr>              <dbl>\n1 Midwest           0.0569\n2 Northeast         0.0537\n3 South             0.0523\n4 West              0.0416\n```\n\n\n:::\n:::\n\n\n\n## Render, commit, and push\n\n1.  Render your Quarto document.\n\n2.  Go to the Git pane and check the box next to each file listed, i.e., stage your changes. Commit your staged changes using a simple and informative message.\n\n3.  Click on push (the green arrow) to push your changes to your application exercise repo on GitHub.\n\n4.  Go to your repo on GitHub and confirm that you can see the updated files. Once your updated files are in your repo on GitHub, you're good to go!\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}